<?php    class B10_Controller extends CI_Controller{        public function __construct() {            parent::__construct();        }        protected function makePage($contexto = '', $template = FALSE,$view = FALSE, $dados = array()){            if($view){                $dados['body']  =   $this->load->view("$contexto/paginas/$view",$dados,TRUE);            }            if(!isset($dados['title'])){                $dados['title'] = $this->config->item('title');            }            if(!isset($dados['description'])){                $dados['description'] = $this->config->item('description');            }            if(!isset($dados['page_title'])){                $dados['page_title']    =   get_last_segment();            }            if(!isset($dados['page_steps'])){                $dados['page_steps'][] = get_last_segment();            }            $dados['ext_files']     =   $this->get_componentes();            $dados['mensagem']      =   $this->session->userdata('mensagem');            if($dados['mensagem']){                $this->session->set_userdata('mensagem', NULL);                $dados['mensagem_titulo']  =   $this->session->userdata('mensagem_titulo');                $dados['mensagem_width']  =   $this->session->userdata('mensagem_width');            }                        if($template === FALSE){                $template = 'padrao';            }            $dados['contexto'] = $contexto;            $dados['view'] = $view;            $dados['template'] = $template;            $dados['tratamentos'] = $this->tratamento->get_menu();            $this->load->view("$contexto/template/$template",$dados);        }                protected function get_componentes(){            $js     =   array();            $css    =   array();            $componentes = $this->session->userdata('componentes');            if(is_array($componentes)){                foreach ($componentes as $itens) {                    if(isset($itens['css'])){                        $css = array_merge($itens['css'],$css);                    }                    if(isset($itens['js'])){                        $js = array_merge($itens['js'],$js);                    }                }            }            return array(                'js'    => array_unique($js),                'css'   => array_unique($css),            );        }                protected function view($view, $vars = array(), $return = FALSE){            $view_config = $this->config->item($view);            if(is_array($view_config)){                $componentes = $this->session->userdata('componentes');                if(!is_array($componentes)){                    $componentes = array();                }                $this->session->set_userdata('componentes', array_merge($componentes,array($view=>$view_config)));            }            return $this->load->view($view, $vars, $return);        }                public function set_componente($view){            $view_config = $this->config->item($view);            if(is_array($view_config)){                $componentes = $this->session->userdata('componentes');                if(!is_array($componentes)){                    $componentes = array();                }                $this->session->set_userdata('componentes', array_merge($componentes,array($view=>$view_config)));                return TRUE;            }            return FALSE;        }    }